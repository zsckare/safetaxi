<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Crear Servicio</title>

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/css/materialize.min.css">

	<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <style>
		.no-mostrar{
			display: none;
		}
		.mostrar{
			display: block;
		}
    </style>
	
</head>
<body>

	<div class="container">
		<div class="row"><div class="center-align" id="title"><h3>Elegir Usuario</h3></div></div>
		<div class="row">
			<div id="users">
				<div class="row">
					<div class="center-align">
						<div class="btn" onclick="crearServicio(1)" >perdir servicio</div>
					</div>
				</div>
			</div>
			<div id="servicio" class="no-mostrar" > 
				<input type="hidden" id="username">
				<input type="hidden" id="userid">
				<input type="hidden" id="useremail">
				<div class="row">
					<div class="center-align" id="pedirservico">
					
					</div>
					<div id="resultado"></div>
				</div>
			</div>
		</div>
	</div>
	
	  
</div>

	
	
	<script>
		url ="http://yoi.dev/client";
		$(document).on("ready",main	);
		function main () {

				
			
		}

		function selectuser (id_client) {
			console.log("¡¡¡¡¡");
			ur="http://yoi.dev/api/client/?id=";
			var urlcliente =ur+id_client;
			console.log("id="+id_client);
			console.log("url="+urlcliente);
			
			$("#userjson").addClass("no-mostrar");
			var nombre="";
			var email="";
			console.log("¡¡¡¡¡");
			$.getJSON(urlcliente,function(da) {
				console.log("-------");
					$.each(da.client, function (i, client) {
						console.log("¡¡¡¡¡"+client.nombre);
						document.getElementById('username').value=client.nombre;
						document.getElementById('useremail').value=client.correo;
					});
			});
			$("#servicio").removeClass("no-mostrar");
			$("#servicio").addClass("mostrar");
			$("#title").empty();
			$("#title").html("<h3>Pedir Servicio</h3>");
			nombre=document.getElementById('username').value;

			var service="<div  class='btn' onclick='crearServicio("+id_client+")'>Pedir</div>";

			$("#pedirservico").html(service);
			
		}

		function crearServicio(id) {
			console.log("CREANDO Servicio");
			console.log("id_cliente"+id)
			var ajax = new XMLHttpRequest();
	

		  	ajax.open("POST","http://yoi.dev/api/newservice",true);
		  	ajax.onreadystatechange=function () {
		  		if (ajax.readyState==4){
		  			console.log("!!!!!!!!!!!!!!!!");
		  			document.getElementById('resultado').value=ajax.responseText;

		  	}
		}
	  	
	  	ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	  	//enviando los valores a registro.php para que inserte los datos
	  	ajax.send("id="+id);


		 	
		}
		

	</script>
</body>
</html>